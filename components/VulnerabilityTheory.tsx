
import React from 'react';
import { Vulnerability, AppLanguage } from '../types';
import { A01_BrokenAccessControl_Theory } from './theory/A01_BrokenAccessControl';
import { A02_CryptographicFailures_Theory } from './theory/A02_CryptographicFailures';
import { A03_Injection_Theory } from './theory/A03_Injection';
import { A04_InsecureDesign_Theory } from './theory/A04_InsecureDesign';
import { A05_SecurityMisconfig_Theory } from './theory/A05_SecurityMisconfig';
import { A06_VulnerableComponents_Theory } from './theory/A06_VulnerableComponents';
import { A07_IdentificationFailures_Theory } from './theory/A07_IdentificationFailures';
import { A08_SoftwareDataFailures_Theory } from './theory/A08_SoftwareDataFailures';
import { A09_LoggingFailures_Theory } from './theory/A09_LoggingFailures';
import { A10_SSRF_Theory } from './theory/A10_SSRF';

interface VulnerabilityTheoryProps {
  vulnerability: Vulnerability;
  // Fix: Added lang prop to interface to match usage in App.tsx
  lang: AppLanguage;
}

// Fix: Destructured lang from props to resolve type error in App.tsx
export const VulnerabilityTheory: React.FC<VulnerabilityTheoryProps> = ({ vulnerability, lang }) => {
  // Router for theory components based on vulnerability ID
  const renderTheory = () => {
    switch (vulnerability.id) {
      case 'a01': return <A01_BrokenAccessControl_Theory vulnerability={vulnerability} />;
      case 'a02': return <A02_CryptographicFailures_Theory vulnerability={vulnerability} />;
      case 'a03': return <A03_Injection_Theory vulnerability={vulnerability} />;
      case 'a04': return <A04_InsecureDesign_Theory vulnerability={vulnerability} />;
      case 'a05': return <A05_SecurityMisconfig_Theory vulnerability={vulnerability} />;
      case 'a06': return <A06_VulnerableComponents_Theory vulnerability={vulnerability} />;
      case 'a07': return <A07_IdentificationFailures_Theory vulnerability={vulnerability} />;
      case 'a08': return <A08_SoftwareDataFailures_Theory vulnerability={vulnerability} />;
      case 'a09': return <A09_LoggingFailures_Theory vulnerability={vulnerability} />;
      case 'a10': return <A10_SSRF_Theory vulnerability={vulnerability} />;
      default: return <div className="p-10 text-center">عذراً، محتوى هذه الثغرة غير متوفر حالياً.</div>;
    }
  };

  return (
    <div className="space-y-6">
      {renderTheory()}
    </div>
  );
};
