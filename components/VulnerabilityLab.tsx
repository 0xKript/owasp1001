
import React from 'react';
import { Vulnerability, AppLanguage } from '../types';
import { A01_BrokenAccessControl_Lab } from './labs/A01_BrokenAccessControl_Lab';
import { A02_CryptographicFailures_Lab } from './labs/A02_CryptographicFailures_Lab';
import { A03_Injection_Lab } from './labs/A03_Injection_Lab';
import { A04_InsecureDesign_Lab } from './labs/A04_InsecureDesign_Lab';
import { A05_SecurityMisconfig_Lab } from './labs/A05_SecurityMisconfig_Lab';
import { A06_VulnerableComponents_Lab } from './labs/A06_VulnerableComponents_Lab';
import { A07_IdentificationFailures_Lab } from './labs/A07_IdentificationFailures_Lab';
import { A08_SoftwareDataFailures_Lab } from './labs/A08_SoftwareDataFailures_Lab';
import { A09_LoggingFailures_Lab } from './labs/A09_LoggingFailures_Lab';
import { A10_SSRF_Lab } from './labs/A10_SSRF_Lab';

interface VulnerabilityLabProps {
  vulnerability: Vulnerability;
  // Fix: Added lang prop to interface to match usage in App.tsx
  lang: AppLanguage;
}

// Fix: Destructured lang from props to resolve type error in App.tsx
export const VulnerabilityLab: React.FC<VulnerabilityLabProps> = ({ vulnerability, lang }) => {
  // Router for Lab components based on vulnerability ID
  const renderLab = () => {
    switch (vulnerability.id) {
      case 'a01':
        return <A01_BrokenAccessControl_Lab vulnerability={vulnerability} />;
      case 'a02':
        return <A02_CryptographicFailures_Lab vulnerability={vulnerability} />;
      case 'a03':
        return <A03_Injection_Lab vulnerability={vulnerability} />;
      case 'a04':
        return <A04_InsecureDesign_Lab vulnerability={vulnerability} />;
      case 'a05':
        return <A05_SecurityMisconfig_Lab vulnerability={vulnerability} />;
      case 'a06':
        return <A06_VulnerableComponents_Lab vulnerability={vulnerability} />;
      case 'a07':
        return <A07_IdentificationFailures_Lab vulnerability={vulnerability} />;
      case 'a08':
        return <A08_SoftwareDataFailures_Lab vulnerability={vulnerability} />;
      case 'a09':
        return <A09_LoggingFailures_Lab vulnerability={vulnerability} />;
      case 'a10':
        return <A10_SSRF_Lab vulnerability={vulnerability} />;
      default:
        return (
          <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
            <div className="bg-surface-dark p-8 rounded-2xl border border-white/5 space-y-8 shadow-2xl min-h-[400px] flex flex-col items-center justify-center text-center">
              <div className="w-24 h-24 bg-primary/10 rounded-full flex items-center justify-center mb-6">
                <span className="material-symbols-outlined text-primary text-5xl">terminal</span>
              </div>
              <h2 className="text-3xl font-bold text-white">بيئة المختبر التفاعلية</h2>
              <p className="text-text-subtle max-w-md mx-auto text-lg leading-relaxed">
                استعد لتطبيق ما تعلمته نظرياً. في هذا المختبر، ستقوم بمحاكاة هجوم على تطبيق ويب مصاب بثغرة 
                <span className="text-primary font-bold"> {vulnerability.arabicName}</span>.
              </p>
              
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 w-full max-w-2xl mt-8">
                <div className="p-4 bg-background-dark rounded-xl border border-white/5 text-right">
                  <span className="text-primary font-bold block mb-1">الهدف:</span>
                  <span className="text-sm text-gray-400">الحصول على الـ Flag المخفي.</span>
                </div>
                <div className="p-4 bg-background-dark rounded-xl border border-white/5 text-right">
                  <span className="text-primary font-bold block mb-1">الصعوبة:</span>
                  <span className="text-sm text-gray-400">{vulnerability.severity}</span>
                </div>
                <div className="p-4 bg-background-dark rounded-xl border border-white/5 text-right">
                  <span className="text-primary font-bold block mb-1">الأدوات:</span>
                  <span className="text-sm text-gray-400">متصفح، Burp Suite.</span>
                </div>
              </div>

              <button className="mt-10 px-12 py-4 bg-primary text-black font-black rounded-xl hover:shadow-glow hover:-translate-y-1 transition-all duration-300 flex items-center gap-2">
                <span className="material-symbols-outlined">rocket_launch</span>
                تشغيل الحاوية (Start Lab)
              </button>
            </div>
          </div>
        );
    }
  };

  return <>{renderLab()}</>;
};
