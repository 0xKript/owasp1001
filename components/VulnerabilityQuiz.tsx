
import React from 'react';
import { Vulnerability, AppLanguage } from '../types';
import { A01_BrokenAccessControl_Quiz } from './quiz/A01_BrokenAccessControl_Quiz';
import { A02_CryptographicFailures_Quiz } from './quiz/A02_CryptographicFailures_Quiz';
import { A03_Injection_Quiz } from './quiz/A03_Injection_Quiz';
import { A04_InsecureDesign_Quiz } from './quiz/A04_InsecureDesign_Quiz';
import { A05_SecurityMisconfig_Quiz } from './quiz/A05_SecurityMisconfig_Quiz';
import { A06_VulnerableComponents_Quiz } from './quiz/A06_VulnerableComponents_Quiz';
import { A07_IdentificationFailures_Quiz } from './quiz/A07_IdentificationFailures_Quiz';
import { A08_SoftwareDataFailures_Quiz } from './quiz/A08_SoftwareDataFailures_Quiz';
import { A09_LoggingFailures_Quiz } from './quiz/A09_LoggingFailures_Quiz';
import { A10_SSRF_Quiz } from './quiz/A10_SSRF_Quiz';

interface VulnerabilityQuizProps {
  vulnerability: Vulnerability;
  // Fix: Added lang prop to interface to match usage in App.tsx
  lang: AppLanguage;
}

// Fix: Destructured lang from props to resolve type error in App.tsx
export const VulnerabilityQuiz: React.FC<VulnerabilityQuizProps> = ({ vulnerability, lang }) => {
  // Router for quiz components based on vulnerability ID
  const renderQuiz = () => {
    switch (vulnerability.id) {
      case 'a01':
        return <A01_BrokenAccessControl_Quiz vulnerability={vulnerability} />;
      case 'a02':
        return <A02_CryptographicFailures_Quiz vulnerability={vulnerability} />;
      case 'a03':
        return <A03_Injection_Quiz vulnerability={vulnerability} />;
      case 'a04':
        return <A04_InsecureDesign_Quiz vulnerability={vulnerability} />;
      case 'a05':
        return <A05_SecurityMisconfig_Quiz vulnerability={vulnerability} />;
      case 'a06':
        return <A06_VulnerableComponents_Quiz vulnerability={vulnerability} />;
      case 'a07':
        return <A07_IdentificationFailures_Quiz vulnerability={vulnerability} />;
      case 'a08':
        return <A08_SoftwareDataFailures_Quiz vulnerability={vulnerability} />;
      case 'a09':
        return <A09_LoggingFailures_Quiz vulnerability={vulnerability} />;
      case 'a10':
        return <A10_SSRF_Quiz vulnerability={vulnerability} />;
      default:
        return (
          <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
            <div className="bg-surface-dark p-8 rounded-2xl border border-white/5 space-y-8 shadow-2xl min-h-[400px]">
              <div className="flex justify-between items-center border-b border-white/5 pb-6">
                <div className="flex items-center gap-3">
                  <span className="material-symbols-outlined text-primary text-3xl">task_alt</span>
                  <h2 className="text-2xl font-bold text-white">اختبار المعرفة</h2>
                </div>
                <div className="text-sm bg-background-dark px-4 py-2 rounded-full border border-white/10 text-text-subtle">
                  السؤال <span className="text-primary font-bold">1</span> من <span className="text-white">5</span>
                </div>
              </div>

              <div className="space-y-6 py-4">
                <h3 className="text-xl text-white font-medium leading-relaxed">
                  أي من العبارات التالية تصف بشكل أفضل كيفية عمل ثغرة <span className="text-primary">{vulnerability.name}</span> في بيئات الويب؟
                </h3>

                <div className="grid grid-cols-1 gap-4">
                  {['خيار تجريبي أ للإجابة الصحيحة', 'خيار تجريبي ب للإجابة الخاطئة', 'خيار تجريبي ج للتشتيت'].map((option, idx) => (
                    <button 
                      key={idx}
                      className="group w-full p-5 bg-background-dark border border-white/5 rounded-xl text-right hover:border-primary/50 transition-all flex items-center justify-between"
                    >
                      <span className="text-gray-300 group-hover:text-white">{option}</span>
                      <div className="w-6 h-6 rounded-full border-2 border-white/10 group-hover:border-primary transition-colors"></div>
                    </button>
                  ))}
                </div>
              </div>

              <div className="flex justify-between items-center pt-6 border-t border-white/5">
                <button className="text-gray-500 font-medium cursor-not-allowed">السابق</button>
                <button className="px-8 py-3 bg-white text-black font-bold rounded-lg hover:bg-primary transition-colors">
                  السؤال التالي
                </button>
              </div>
            </div>
          </div>
        );
    }
  };

  return <>{renderQuiz()}</>;
};
